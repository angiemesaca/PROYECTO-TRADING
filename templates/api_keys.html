{% extends "base.html" %}

{% block title %}API Keys{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        
        <div class="d-flex align-items-center mb-4">
            <div class="bg-black border border-secondary text-info rounded-circle d-flex align-items-center justify-content-center me-3 shadow" style="width: 60px; height: 60px; font-size: 1.5rem;">
                <i class="bi bi-key-fill"></i>
            </div>
            <div>
                <h2 class="text-white fw-bold mb-0">Gestión de API Keys</h2>
                <p class="text-secondary mb-0">Conecta tus cuentas de Exchange reales.</p>
            </div>
        </div>

        <div class="card bg-dark border-secondary shadow-lg mb-4">
            <div class="card-header border-secondary">
                <i class="bi bi-plus-circle text-success me-2"></i>Agregar Nueva Llave
            </div>
            <div class="card-body p-4">
                <form action="{{ url_for('api_keys') }}" method="POST">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <input type="text" name="exchange" class="form-control bg-black text-white border-secondary" placeholder="Exchange (Ej: Binance)" required>
                        </div>
                        <div class="col-md-4">
                            <input type="text" name="api_key" class="form-control bg-black text-white border-secondary" placeholder="API Key" required>
                        </div>
                        <div class="col-md-4">
                            <input type="password" name="api_secret" class="form-control bg-black text-white border-secondary" placeholder="API Secret" required>
                        </div>
                        <div class="col-12 text-end">
                            <button type="submit" class="btn btn-success btn-sm fw-bold px-4">Guardar</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <div class="card bg-dark border-secondary">
            <div class="card-header border-secondary">
                <i class="bi bi-list-ul text-white me-2"></i>Llaves Guardadas
            </div>
            <ul class="list-group list-group-flush">
                {% for key in keys %}
                <li class="list-group-item bg-dark text-white border-secondary d-flex justify-content-between align-items-center p-3">
                    <div>
                        <strong class="text-warning text-uppercase">{{ key.exchange }}</strong>
                        <div class="text-secondary small font-monospace">
                            {{ key.api_key[:6] }}...{{ key.api_key[-4:] }}
                        </div>
                    </div>
                    <form action="{{ url_for('delete_api_key') }}" method="POST" onsubmit="return confirm('¿Borrar esta llave?');">
                        <input type="hidden" name="exchange_name" value="{{ key.exchange }}">
                        <button type="submit" class="btn btn-outline-danger btn-sm border-0">
                            <i class="bi bi-trash"></i>
                        </button>
                    </form>
                </li>
                {% else %}
                <li class="list-group-item bg-dark text-secondary text-center py-4 border-secondary">
                    No tienes API Keys guardadas.
                </li>
                {% endfor %}
            </ul>
        </div>

    </div>
</div>
{% endblock %}